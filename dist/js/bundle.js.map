{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/AjaxSend.js","webpack:///./src/ModalWindow.js","webpack:///./src/PhoneTemplate.js","webpack:///./src/index.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA,uEAAuE,eAAe;;AAEtF;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,SAAS;AACT;AACA;AACA;;;;;;;;;;;;AC/BA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,6B;;;;;;;;;;;ACvCA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,+B;;;;;;;;;;;;ACrGa;;AAEb;;AAEA;AACA,sBAAsB,mBAAO,CAAC,8CAAkB;AAChD,sBAAsB,mBAAO,CAAC,wCAAe;AAC7C,wBAAwB,mBAAO,CAAC,kDAAoB;;AAEpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA,sEAAsE,gBAAgB,EAAE;AACxF;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA,0EAA0E,gBAAgB,EAAE;AAC5F;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL,CAAC","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","class AjaxSend {\n    ajaxSendResponce(formElement, method, url) {\n        return new Promise(function(resolve, reject) {\n            let formData = new FormData(formElement),\n                request = new XMLHttpRequest(),\n                obj = {};\n            formData.forEach((value, key) => {\n                obj[key] = value;\n            });\n\n            request.open(method, url);\n            request.setRequestHeader('Content-Type', 'application/json; charset=utf-8;');\n\n            request.onload = function() {\n                if (this.status === 200) {\n                    resolve(this.response);\n                } else {\n                    let error = new Error(this.statusText);\n                    error.code = this.status;\n                    reject(error);\n                }\n            };\n\n            request.onerror = function() {\n                reject(new Error(\"Network Error\"));\n            };\n\n            request.send(JSON.stringify(obj));\n        });\n    }\n}\nmodule.exports = AjaxSend;\n","class ModalWindow {\n    constructor(modalElement, overlay, triggers, closers) {\n        this.modalElement = modalElement;\n        this.overlay = overlay;\n        this.triggers = triggers;\n        this.closers = closers;\n\n        this.initModal();\n    }\n\n    initModal() {\n        this.triggers.forEach((item) => item.addEventListener('click', (event) => {\n            this.modalShow();\n        }));\n\n        this.closers.forEach((item) => item.addEventListener('click', (event) => {\n            this.modalHide();\n        }));\n\n        this.overlay.addEventListener('click', (event) => {\n            if (event.target === this.overlay) {\n                this.modalHide();\n            }\n        });\n    }\n\n    modalShow() {\n        this.modalElement.style.display = 'block';\n        this.overlay.style.display = 'block';\n        document.body.style.overflow = 'hidden';\n    }\n\n    modalHide() {\n        this.modalElement.style.display = 'none';\n        this.overlay.style.display = 'none';\n        document.body.style.overflow = '';\n    }\n}\n\nmodule.exports = ModalWindow;","class PhoneTemplate {\n\n    constructor(phoneInputElement, template, startPos) {\n        String.prototype.replaceAt=function(index, replacement) {\n            return this.substr(0, index) + replacement+ this.substr(index + replacement.length);\n        };\n\n        this.phoneInput = phoneInputElement;\n        this.template = template;\n        this.curentString = template;\n        this.startPosition = startPos;\n        this.keyCode = '';\n        this.phoneInput.value = template;\n        this.setCursorPosition(startPos);\n\n        this.startObservers();\n    }\n\n    isValid() {\n        if (this.curentString.indexOf('_') === -1) {\n            return true;\n        }\n        return false;\n    }\n\n    startObservers() {\n        document.addEventListener('keydown', (event) => {\n            this.keyCode = event.key;\n        });\n\n        document.addEventListener('input', (event) => {\n            if (this.serviceKey() === true) {\n                return;\n            }\n            let inputValue = this.phoneInput.value,\n                currentPosition = this.phoneInput.selectionStart,\n                inputPosition = this.phoneInput.selectionStart - 1;\n\n            while (this.template[inputPosition] !== '_' && inputPosition < this.template.length) {\n                inputPosition++;\n                this.setCursorPosition(inputPosition);\n            }\n\n            if (!isNaN(parseInt(inputValue[inputPosition])) && this.template[inputPosition] === '_') {\n                this.curentString = this.curentString.replaceAt(inputPosition, inputValue[inputPosition]);\n                this.setInput(this.curentString);\n                this.setCursorPosition(currentPosition);\n            } else {\n                this.setInput(this.curString);\n                this.setCursorPosition(inputPosition);\n            }\n\n            while (this.template[currentPosition] !== '_' && currentPosition < this.template.length) {\n                currentPosition++;\n                this.setCursorPosition(currentPosition);\n            }\n\n        });\n    }\n\n    clearField() {\n        this.curentString = this.template;\n        this.phoneInput.value = this.template;\n        this.setCursorPosition(this.startPosition);\n        this.phoneInput.focus();\n    }\n\n    setInput(text = '') {\n        this.curentString = text === '' ? this.curentString : text;\n        this.phoneInput.value = this.curentString;\n    }\n\n    setCursorPosition(pos) {\n        this.phoneInput.setSelectionRange(pos,pos);\n    }\n\n    serviceKey() {\n        let keyCode = this.keyCode,\n            currentPosition = this.phoneInput.selectionStart;\n\n        if (keyCode === 'ArrowLeft' || keyCode === 'ArrowRight') {\n            return true;\n        }\n\n        if (keyCode === 'Delete') {\n            return true;\n        }\n\n        if (keyCode === 'Backspace') {\n            while (this.template[currentPosition] !== '_' && currentPosition > 0) {\n                currentPosition--;\n            }\n            this.curentString = this.curentString.replaceAt(currentPosition, this.template[currentPosition]);\n            this.setInput();\n            this.setCursorPosition(currentPosition);\n            return true;\n        }\n        return false;\n    }\n}\n\nmodule.exports = PhoneTemplate;","'use strict';\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n\n    //Modal popups\n    let ModalWindow = require('./ModalWindow.js'),\n        AjaxRequest = require('./AjaxSend.js'),\n        PhoneTemplate = require('./PhoneTemplate.js');\n\n    let modalCheckout = new ModalWindow(\n            document.querySelector('.popup-design .popup-dialog'),\n            document.querySelector('.popup-design'),\n            document.querySelectorAll('.button-design'),\n            [\n                document.querySelector('.popup-design .popup-close'),\n            ]),\n        modalConsultation = new ModalWindow(\n            document.querySelector('.popup-consultation .popup-dialog'),\n            document.querySelector('.popup-consultation'),\n            document.querySelectorAll('.button-consultation'),\n            [\n                document.querySelector('.popup-consultation .popup-close'),\n            ]);\n\n    let ajax = new AjaxRequest();\n\n    let messages = {\n        ajaxSuccess: {\n            text: 'Собщение отправлено',\n            class: 'success',\n        },\n        ajaxProcess: {\n            text: 'Отправка',\n            class: 'process',\n        },\n        ajaxError: {\n            text: 'Ошибка',\n            class: 'error',\n        },\n        invalidPhone: {\n            text: 'Заполните поле телефона'\n        }\n    };\n\n    function toggle(element, state = '') {\n        if (state === '') {\n            element.style.display = element.style.display === \"none\" ? 'block' : 'none';\n        } else {\n            element.style.display = state;\n        }\n    }\n\n    //ajax submit for checkout modal window\n    (() => {\n        //create message div block\n        let messageContainer = document.createElement('div'),\n            messageText = document.createElement('div'),\n            messageImage = document.createElement('div');\n        messageContainer.className = 'popup-message-content';\n        messageText.className = 'popup-message-text';\n        messageImage.className = 'popup-message-image';\n        messageContainer.appendChild(messageImage);\n        messageContainer.appendChild(messageText);\n        messageContainer.setAttribute('display', 'none');\n\n\n        let checkoutWindow = document.querySelector('.popup-design .popup-content'),\n            checkoutForm = checkoutWindow.querySelector('.popup-dialog form'),\n            checkoutSubmitButton = checkoutWindow.querySelector('.button-order'),\n            checkoutInputPhone = checkoutWindow.querySelector('input[name=phone]');\n\n        let phoneCheckout = new PhoneTemplate(checkoutInputPhone, '+375 (__) ___-__-__', 6);\n        checkoutWindow.appendChild(messageContainer);\n\n        //phone validation\n        checkoutSubmitButton.addEventListener('mouseover', (event) => {\n            if (phoneCheckout.isValid() !== true) {\n                checkoutInputPhone.focus();\n                checkoutInputPhone.setCustomValidity(messages.invalidPhone.text);\n            } else {\n                checkoutInputPhone.setCustomValidity('');\n            }\n        });\n        checkoutSubmitButton.addEventListener('mouseleave', (event) => {\n            checkoutInputPhone.setCustomValidity('');\n        });\n\n        //text validation\n        checkoutWindow.querySelector('input[name=name]').addEventListener('input',(event)=> {\n            event.target.value = event.target.value.replace(/[^а-я]/gi,'');\n        });\n        checkoutWindow.querySelector('textarea[name=message]').addEventListener('input',(event)=> {\n            event.target.value = event.target.value.replace(/[^а-я]/gi,'');\n        });\n        checkoutWindow.querySelector('input[name=email]').setAttribute('type', 'email');\n\n        function resetForm() {\n            modalCheckout.modalHide();\n            checkoutForm.querySelectorAll('input').forEach((item) => {item.value = ''; });\n            messageContainer.style.display = 'none';\n            checkoutForm.style.display = 'block';\n            phoneCheckout.clearField();\n        }\n\n        //ajax send\n        checkoutForm.addEventListener('submit', (event) => {\n            event.preventDefault();\n\n            messageImage.classList.add(messages.ajaxProcess.class);\n            messageText.innerHTML = messages.ajaxProcess.text;\n            messageContainer.style.display = 'block';\n            checkoutForm.style.display = 'none';\n\n            ajax.ajaxSendResponce(checkoutForm,'POST', 'server.php')\n                .then(\n                    responce =>  {\n                        messageImage.classList.remove(messages.ajaxProcess.class);\n                        messageImage.classList.add(messages.ajaxSuccess.class);\n                        messageText.innerHTML = messages.ajaxSuccess.text;\n                        setTimeout(() => resetForm(), 5000);\n                    },error =>  {\n                        messageImage.classList.remove(messages.ajaxProcess.class);\n                        messageImage.classList.add(messages.ajaxError.class);\n                        messageText.innerHTML = messages.ajaxError.text;\n                        setTimeout(() => resetForm(), 5000);\n                    }\n                );\n        });\n    })();\n\n\n    //ajax submit for consultation modal window\n    (() => {\n        //create message div block\n        let messageContainer = document.createElement('div'),\n            messageText = document.createElement('div'),\n            messageImage = document.createElement('div');\n        messageContainer.className = 'popup-message-content';\n        messageText.className = 'popup-message-text';\n        messageImage.className = 'popup-message-image';\n        messageContainer.appendChild(messageImage);\n        messageContainer.appendChild(messageText);\n        messageContainer.setAttribute('display', 'none');\n\n        let consultationWindow = document.querySelector('.popup-consultation .popup-content'),\n            consultationForm = consultationWindow.querySelector('.popup-dialog form'),\n            consultationSubmitButton = consultationWindow.querySelector('.button-order'),\n            consultationInputPhone = consultationWindow.querySelector('input[name=phone]');\n        let phoneConsultation = new PhoneTemplate(consultationInputPhone, '+375 (__) ___-__-__', 6);\n        consultationWindow.appendChild(messageContainer);\n\n        //phone validation\n        consultationSubmitButton.addEventListener('mouseover', (event) => {\n            if (phoneConsultation.isValid() !== true) {\n                consultationInputPhone.focus();\n                consultationInputPhone.setCustomValidity(messages.invalidPhone.text);\n            } else {\n                consultationInputPhone.setCustomValidity('');\n            }\n        });\n        consultationSubmitButton.addEventListener('mouseleave', (event) => {\n            consultationInputPhone.setCustomValidity('');\n        });\n\n        //text validation\n        consultationWindow.querySelector('input[name=name]').addEventListener('input',(event)=> {\n            event.target.value = event.target.value.replace(/[^а-я]/gi,'');\n        });\n\n        function resetForm() {\n            modalCheckout.modalHide();\n            consultationForm.querySelectorAll('input').forEach((item) => {item.value = ''; });\n            messageContainer.style.display = 'none';\n            consultationForm.style.display = 'block';\n            phoneConsultation.clearField();\n        }\n\n        //ajax send\n        consultationForm.addEventListener('submit', (event) => {\n            event.preventDefault();\n\n            messageImage.classList.add(messages.ajaxProcess.class);\n            messageText.innerHTML = messages.ajaxProcess.text;\n            messageContainer.style.display = 'block';\n            consultationForm.style.display = 'none';\n\n            ajax.ajaxSendResponce(consultationForm,'POST', 'server.php')\n                .then(\n                    responce =>  {\n                        messageImage.classList.remove(messages.ajaxProcess.class);\n                        messageImage.classList.add(messages.ajaxSuccess.class);\n                        messageText.innerHTML = messages.ajaxSuccess.text;\n                        setTimeout(() => resetForm(), 5000);\n                    },error =>  {\n                        messageImage.classList.remove(messages.ajaxProcess.class);\n                        messageImage.classList.add(messages.ajaxError.class);\n                        messageText.innerHTML = messages.ajaxError.text;\n                        setTimeout(() => resetForm(), 5000);\n                    }\n                );\n        });\n    })();\n\n});\n\n\n"],"sourceRoot":""}